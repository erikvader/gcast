<html>
  <head></head>
  <body>
    <script type="text/javascript">
      const module = {}
    </script>
    <script type="module">
      import init, {State, init_rust} from "./pkg/client.js"
      async function run() {
          await init()
          console.log("init")
          init_rust()
          console.log("init_rust")

          let state = State.new(5)
          state.register(n => {
              console.log(n)
              document.getElementById("hej").style.color = "red"
          });
          state.call_it()
      }
      run()

      const ws = new WebSocket("ws://127.0.0.1:1337");
      ws.addEventListener("message", e => {
          console.log("message from server ", event.data)
      })
      ws.addEventListener("close", e => {
          console.log("disconnected")
      })
      ws.addEventListener("open", e => {
          ws.send("omg")
      })
    </script>

    <div id="hej">hej</div>
  </body>
</html>
